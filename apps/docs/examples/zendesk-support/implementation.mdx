---
title: "Implementation"
description: "Building the Zendesk support agent with enhanced capabilities using Amazon Bedrock LLM"
---

## Actions

### Get Customer Info

```typescript
import { createAction } from "spinai";
import { ZendeskAPI } from "@zendesk/api";

export const getCustomerInfo = createAction({
  id: "getCustomerInfo",
  description: "Get customer information from Zendesk",
  async run(context) {
    const zendesk = new ZendeskAPI({
      subdomain: process.env.ZENDESK_SUBDOMAIN,
      token: process.env.ZENDESK_API_TOKEN,
    });

    const email = extractEmail(context.input);
    const user = await zendesk.users.search({ email });

    context.state.customer = user;
    return context;
  },
});
```

### Create Ticket

```typescript
import { createAction } from "spinai";

export const createTicket = createAction({
  id: "createTicket",
  description: "Create a new support ticket",
  dependsOn: ["getCustomerInfo"],
  async run(context) {
    const { customer } = context.state;

    const ticket = await zendesk.tickets.create({
      subject: "Support Request",
      comment: { body: context.input },
      requester_id: customer.id,
      priority: "normal",
    });

    context.state.ticket = ticket;
    return context;
  },
});
```

## Agent Setup

```typescript
import { createAgent, createOpenAILLM, createBedrockLLM } from "spinai";
import { getCustomerInfo } from "./actions/getCustomerInfo";
import { createTicket } from "./actions/createTicket";
import { getTicketStatus } from "./actions/getTicketStatus";

// Example using OpenAI's LLM
// const llm = createOpenAILLM({
//   apiKey: process.env.OPENAI_API_KEY,
// });

// Example using Amazon Bedrock LLM
const llm = createBedrockLLM({
  model: "amazon.nova-micro-v1:0"
});

const supportAgent = createAgent({
  instructions: `You are a helpful support agent that can:
    - Look up customer information
    - Create support tickets
    - Check ticket status
    Always verify customer information before creating tickets.`,
  actions: [getCustomerInfo, createTicket, getTicketStatus],
  llm,
});

// Use the agent
const { response } = await supportAgent({
  input: "I need help with my account",
  state: {},
});
```

## Error Handling

```typescript
const createTicket = createAction({
  id: "createTicket",
  description: "Create a new support ticket",
  retries: 3, // Retry on API failures
  async run(context) {
    try {
      // ... ticket creation logic
    } catch (error) {
      if (error.status === 429) {
        // Rate limit hit, retry
        throw new Error("Rate limit exceeded");
      }
      throw error;
    }
  },
});
```

## Integrating Bedrock LLM with Zendesk Support

The integration of Amazon Bedrock LLM into the Zendesk support agent framework enhances the agent's ability to understand and categorize customer queries more efficiently. This section demonstrates how to leverage Bedrock LLM for ticket categorization, ensuring that support tickets are directed to the most appropriate department or support agent.

### Using Bedrock LLM for Ticket Categorization

To implement ticket categorization using Bedrock LLM, follow the example below:

```typescript
import { createBedrockLLM } from "spinai";

const llm = createBedrockLLM({
  model: "amazon.nova-micro-v1:0"
});

async function categorizeTicket(input: string): Promise<string> {
  const categories = ['Billing', 'Technical Support', 'General Inquiry'];
  const response = await llm.generate({
    prompt: `Categorize the following customer support ticket: "${input}"\nCategories: ${categories.join(', ')}\nCategory:`,
    maxTokens: 60,
  });

  return response.text.trim();
}

// Example usage
const ticketCategory = await categorizeTicket("I'm having trouble logging into my account.");
console.log(`Ticket Category: ${ticketCategory}`);
```

This example demonstrates how to use Bedrock LLM to categorize a customer support ticket into predefined categories. By providing the LLM with a prompt that includes the customer's request and a list of possible categories, it can generate a response that indicates the most appropriate category for the ticket. This can significantly streamline the ticket routing process, ensuring that customers receive timely and relevant support.

## Next Steps

<CardGroup>
  <Card
    title="Configuration"
    icon="gear"
    href="/examples/zendesk-support/configuration"
  >
    Configure Zendesk integration
  </Card>
  <Card title="More Examples" icon="lightbulb" href="/examples">
    Explore other examples
  </Card>
</CardGroup>

This documentation has been updated to include examples demonstrating the integration of Amazon Bedrock LLM with a Zendesk support agent, enhancing its capabilities in customer support scenarios. For more detailed information on Amazon Bedrock LLM, refer to the planned documentation at `apps/docs/llms/bedrock.mdx`.